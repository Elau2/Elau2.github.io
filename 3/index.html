<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Fun with Filters and Frequencies</title>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f4f4f4;
        }

        h1 {
            margin-top: 10%;
            margin-bottom: 20px;
            padding-right: 20%;
            padding-left: 20%;
        }

        h2 {
            margin-top: 20px;
            margin-bottom: 20px;
            padding-right: 20%;
            padding-left: 20%;
        }

        p.description {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: #555;
            padding-right: 20%;
            padding-left: 20%;
        }

        .static-image {
            text-align: center;
            margin-bottom: 30px;
            padding-right: 30%;
            padding-left: 30%;
            margin-top: 5%;
            margin-bottom: 5%;
        }

        .static-image img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding-right: 20%;
            padding-left: 20%;
            margin-top: 5%;
            margin-bottom: 5%;
        }

        .gallery-item {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }

        .gallery-item:hover {
            transform: scale(1.02);
        }

        .gallery-item img {
            width: 100%;
            display: block;
        }

        .caption {
            padding: 10px;
            font-size: 1rem;
            text-align: center;
            color: #333;
        }

        .MathJax {
            font-size: 1.2em !important;
        }
    </style>

    <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
        </script>
</head>

<body>

    <h1>Fun with Filters and Frequencies</h1>


    <p class="description">
        Ethan Lau
    </p>

    <h2>Part 1.1 Convolutions From Scratch</h2>

    <p class="description">
        Listed below are methods for calculating image convolutions, one naive method utilizing 4 for loops, and another
        utilizing 2 for loops and numpy's built in parallelization. Using rough observation, the 4 loop convolution
        method took about 50s compared to 10s to produce the three convoluted images below. One is a convolution with a
        9x9 box filter, while the others are a convolution with the difference operator in the x and y directions.
    </p>

    <div class="static-image">
        <img src="./media/4loop.png" alt="Featured Static Image">
    </div>

    <div class="static-image">
        <img src="./media/2loop.png" alt="Featured Static Image">
    </div>

    <div class="gallery">
        <div class="gallery-item">
            <img src="./media/ethan.jpg" alt="Sample 1">
            <div class="caption">Original Image</div>
        </div>
        <div class="gallery-item">
            <img src="./media/ethan_box.jpg" alt="Sample 2">
            <div class="caption">9x9 Box Filter</div>
        </div>
        <div class="gallery-item">
            <img src="./media/ethan_dx.jpg" alt="Sample 3">
            <div class="caption">Dx Operator</div>
        </div>
        <div class="gallery-item">
            <img src="./media/ethan_dy.jpg" alt="Sample 1">
            <div class="caption">Dy Operator</div>
        </div>
    </div>


    <h2>Part 1.2 Finite Difference Operator</h2>

    <p class="description">
        Rudimentary edge detection was created through convolution with the finite difference operators listed below.
        The magnitude of the edge was then calculated using the euclidian norm and binarized using an arbitrrary cutoff.

        $$D_x =
        \begin{bmatrix}
        1 & 0 & -1
        \end{bmatrix}
        $$

        $$D_y =
        \begin{bmatrix}
        1 \\
        0 \\
        -1 \\
        \end{bmatrix}
        $$

        $$D = \sqrt{D_x^2 + D_y^2}$$

        Listed below are the results of edge detection using a finite difference operator.
    </p>

    <div class="gallery">
        <div class="gallery-item">
            <img src="./media/cameraman.png" alt="Sample 1">
            <div class="caption">Original Image</div>
        </div>
        <div class="gallery-item">
            <img src="./media/cameraman_edge.png" alt="Sample 2">
            <div class="caption">Edge Image</div>
        </div>

    </div>
    </div>

    <h2>Part 1.3 Derivative of Gaussian Filter</h2>

    <p class="description">
        A 2-dimensional gaussian kernel is created by taking the outer product of a 1D gaussian and its transpose. When
        convoluted over the image, a gaussian blur is created. When a gaussian blur is first applied to the image, the
        edges are smoothed out and more clearly defined. Convolving the difference operator with the gaussian kernel as
        a single filter also provided identical results.
    </p>

    <div class="gallery">
        <div class="gallery-item">
            <img src="./media/dogx.png" alt="Sample 1">
            <div class="caption">Derivative of Gaussian (x)</div>
        </div>
        <div class="gallery-item">
            <img src="./media/dogy.png" alt="Sample 2">
            <div class="caption">Derivative of Gaussian (y)</div>
        </div>

    </div>
    </div>

    <p class="description">
        Listed below is the results of the binarized derivative of gaussian filter applied sequentially and as a single
        filter. As shown below, the procedures are mathematically equivalent.
    </p>

    <div class="gallery">
        <div class="gallery-item">
            <img src="./media/cameraman_gaussian.png" alt="Sample 1">
            <div class="caption">Sequential Result</div>
        </div>
        <div class="gallery-item">
            <img src="./media/cameraman_gaussian_convolve.png" alt="Sample 2">
            <div class="caption">Single Filter Result</div>
        </div>

    </div>


    <h2>Part 2.1 Image Sharpening</h2>

    <p class="description">
        Images can be artificially sharpened by increasing the weight of higher frequencies. This can be done through
        something called an unsharp mask filter. High frequencies are extracted from an image by taking the difference
        of
        the original image an its gaussian blur. This difference is then added back on top of the original image. This
        process can be represented as a single filter noted below.

        $$f + \alpha(f - f * g)$$
        $$= (1 + \alpha)f - \alpha f * g$$
        $$= f * [(1 + \alpha)\delta - \alpha g]$$

        where \(f\) is the image, \(g\) is a gaussian filter, and \(\delta\) is a unit impulse. Listed below is an
        application of the unsharp mask filter on a variety of images.
    </p>

    <div class="gallery">
        <div class="gallery-item">
            <img src="./media/taj.jpg" alt="Sample 1">
            <div class="caption">Original Image</div>
        </div>
        <div class="gallery-item">
            <img src="./media/taj_sharpened.jpg" alt="Sample 2">
            <div class="caption">Sharpened Image</div>
        </div>
    </div>


    <div class="gallery">
        <div class="gallery-item">
            <img src="./media/bird.png" alt="Sample 1">
            <div class="caption">Sequential Result</div>
        </div>
        <div class="gallery-item">
            <img src="./media/bird_blurred.jpg" alt="Sample 2">
            <div class="caption">Single Filter Result</div>
        </div>
        <div class="gallery-item">
            <img src="./media/bird_blurred_sharpened.jpg" alt="Sample 2">
            <div class="caption">Single Filter Result</div>
        </div>
    </div>

    <h2>Part 2.2 Hybrid Images</h2>

    <p class="description">
        Hybrid images are static images that can be interpreted differnetly based on viewing distance. When up close,
        high frequencies dominate the perception of the image while at a distance, low frequencies do. This gives rise
        to these hybrid images shown below.
    </p>

    <div class="gallery">
        <div class="gallery-item">
            <img src="./media/nutmeg.jpg" alt="Sample 1">
            <div class="caption">Input Image</div>
        </div>
        <div class="gallery-item">
            <img src="./media/DerekPicture.jpg" alt="Sample 2">
            <div class="caption">Input Image</div>
        </div>
        <div class="gallery-item">
            <img src="./media/hybrid-derek-nutmeg.jpg" alt="Sample 2">
            <div class="caption">Hybrid Image</div>
        </div>
    </div>
    <div class="gallery">
        <div class="gallery-item">
            <img src="./media/king.webp" alt="Sample 1">
            <div class="caption">Input Image</div>
        </div>
        <div class="gallery-item">
            <img src="./media/harvey.jpeg" alt="Sample 2">
            <div class="caption">Input Image</div>
        </div>
        <div class="gallery-item">
            <img src="./media/hybrid-king-harvey.jpg" alt="Sample 2">
            <div class="caption">Hybrid Image</div>
        </div>
    </div>
    <div class="gallery">
        <div class="gallery-item">
            <img src="./media/dog.jpg" alt="Sample 1">
            <div class="caption">Input Image</div>
        </div>
        <div class="gallery-item">
            <img src="./media/cat.jpg" alt="Sample 2">
            <div class="caption">Input Image</div>
        </div>
        <div class="gallery-item">
            <img src="./media/hybrid-dog-cat.jpg" alt="Sample 2">
            <div class="caption">Hybrid Image</div>
        </div>
    </div>
    <p class="description">
        When we look at the dog-cat image in the fourier domain, we see higher frequencies (those farther from the
        origin) are supressed when put through a low pass filter. Higher frequencies in the cat image are then
        highlighted when put through a high pass filter.
    </p>

    <div class="gallery">
        <div class="gallery-item">
            <img src="./media/dog_fourier.png" alt="Sample 1">
            <div class="caption">Original Dog Image</div>
        </div>
        <div class="gallery-item">
            <img src="./media/cat_fourier.png" alt="Sample 2">
            <div class="caption">Original Cat Image</div>
        </div>
        <div class="gallery-item">
            <img src="./media/dog_blur_fourier.png" alt="Sample 2">
            <div class="caption">Low Pass Filtered Dog Image</div>
        </div>
        <div class="gallery-item">
            <img src="./media/cat_highfreq_fourier.png" alt="Sample 2">
            <div class="caption">High Pass Filtered Cat Image</div>
        </div>
        <div class="gallery-item">
            <img src="./media/dog_cat_fourier.png" alt="Sample 2">
            <div class="caption">Hybrid Image</div>
        </div>
    </div>

    <h2>2.3 Gaussian and Laplacian Stacks</h2>

    <p class="description">
        Often times when blending two images together there exists a hard boundary between the two input images.
        Blending images smoothly can be done through a multilayer combination of a laplacian stack. First both images
        and a mask are sequentially blurred with a gaussian kernel. Then, the difference of each gaussian stack layer is
        used to create the laplacian stack, each weighted by the corresponding layer of the mask's gaussian stack.
    </p>
    <p class="description">
        Shown below is a
        laplcian stack of an apple and an orange, with higher frequency items shown on the top and the final gaussian
        blur found on the second to last row. The last row contains the final result and the contributions of each of
        the original images. The left and middle columns represent the original images weighted by a blurred mask, while
        the right most column is each row's contribution to the final image.
    </p>

    <div class="gallery">
        <div class="gallery-item">
            <img src="./media/orange.jpeg" alt="Sample 1">
            <div class="caption">Input Image</div>
        </div>
        <div class="gallery-item">
            <img src="./media/apple.jpeg" alt="Sample 2">
            <div class="caption">Input Image</div>
        </div>
        <div class="gallery-item">
            <img src="./media/orapple_hybrid.jpg" alt="Sample 2">
            <div class="caption">Orapple Blended Image</div>
        </div>
    </div>

    <div class="static-image">
        <img src="./media/laplacian-stack.png" alt="Featured Static Image">
    </div>

    <h2>2.4 Multiresolution Blending</h2>

    <p class="description">
        The above process does not only work for linear masks (i.e the apple and orange were blended down the middle).
        Listed below is an example of a non-linear mask blending, placing a bear in a wintery background. (Please zoom
        in for the laplacian stack as this is a high defenition image.)
    </p>

    <div class="gallery">
        <div class="gallery-item">
            <img src="./media/bear.jpg" alt="Sample 1">
            <div class="caption">Input Image</div>
        </div>
        <div class="gallery-item">
            <img src="./media/snow2.jpeg" alt="Sample 2">
            <div class="caption">Input Image</div>
        </div>
        <div class="gallery-item">
            <img src="./media/mask.jpg" alt="Sample 2">
            <div class="caption">Nonlinear Mask</div>
        </div>
        <div class="gallery-item">
            <img src="./media/snowbear.jpg" alt="Sample 2">
            <div class="caption">Bear in Snow Blended Image</div>
        </div>
    </div>

    <div class="static-image">
        <img src="./media/laplacian-stack-bear.png" alt="Featured Static Image">
    </div>
</body>

</html>